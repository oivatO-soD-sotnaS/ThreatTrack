import { n8n_vulnerability } from "@/app/generated/prisma";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";
import { ChevronRight } from "lucide-react";

export default function VulnerabilityItem({ vuln }: { vuln: n8n_vulnerability }) {
  return (
    <Card className="w-full hover:bg-accent flex flex-col gap-2 p-3 border rounded-lg shadow-sm">
      {/* Header: componente + criticidade */}
      <div className="flex justify-between items-start">
        <div className="flex flex-col gap-1">
          <span className="font-semibold text-sm">{vuln.title ?? "(sem título)"}</span>
          {vuln.component_name && <span className="text-xs text-muted-foreground">{vuln.component_name}</span>}
        </div>
        {vuln.criticality !== null && (
          <Badge variant={'destructive'} className="text-sm">
            Crit: {vuln.criticality}
          </Badge>
        )}
      </div>

      {/* Description */}
      <p className="text-xs text-muted-foreground line-clamp-3">{vuln.description ?? "Sem descrição."}</p>

      {/* Footer: severidade + SLA + botão */}
      <div className="flex justify-between items-center mt-2">
        <div className="flex flex-wrap gap-1">
          {vuln.severity && <Badge className="text-xs">{vuln.severity}</Badge>}
          {vuln.sla_deadline && <span className="text-xs italic">{`SLA: ${vuln.sla_deadline}`}</span>}
        </div>
        <Button size="sm" variant="secondary" className="flex items-center gap-1">
          <ChevronRight className="w-3 h-3" />
          Ver mais
        </Button>
      </div>
    </Card>
  );
}
