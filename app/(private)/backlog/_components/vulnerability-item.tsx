import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Card, CardAction, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { ChevronRight } from "lucide-react";
import { Vulnerability } from "../page";

function getCriticalityColor(criticality?: number | null) {
  if (!criticality) return "secondary";
  if (criticality >= 9) return "destructive";
  if (criticality >= 7) return "default";
  if (criticality >= 4) return "outline";
  return "secondary";
}

export default function VulnerabilityItem({ vuln }: { vuln: Vulnerability }) {
  return (
    <Card className="w-full hover:bg-accent">
      <CardHeader>
        <CardTitle>{vuln.title ?? "(sem título)"}</CardTitle>
        <CardDescription>{vuln.description ?? "Sem descrição."}</CardDescription>
        <CardAction>
          <Button variant={'secondary'}>
            <ChevronRight />
            Ver mais
          </Button>
        </CardAction>
      </CardHeader>
      <CardContent className="mt-2 flex flex-wrap items-center gap-2 text-xs text-muted-foreground">
        {vuln.component_name && <Badge variant="secondary">{vuln.component_name}</Badge>}
        {vuln.severity && <Badge>{vuln.severity}</Badge>}
        {vuln.cvssv3_score && <span>CVSS: {vuln.cvssv3_score}</span>}
        {vuln.epss_score && <span>EPSS: {vuln.epss_score}</span>}
        {vuln.criticality !== null && <Badge variant={getCriticalityColor(vuln.criticality)}>Crit: {vuln.criticality}</Badge>}
        {vuln.sla_deadline && <span className="italic">SLA: {vuln.sla_deadline}</span>}
      </CardContent>
    </Card>
  );
}